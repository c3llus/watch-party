sequenceDiagram
    participant U as User (Logged-in)
    participant API as api-service
    participant Sync as sync-service
    participant DB as PostgreSQL

    U->>API: GET /rooms/{roomId}
    Note over U, API: Request includes User's JWT
    API->>DB: VERIFY user has access in 'room_access' table
    DB-->>API: Access confirmed
    API-->>U: HTTP 200 OK (Room details, movie info)

    U->>Sync: WebSocket Upgrade Request to /ws/room/{roomId}
    Note over U, Sync: Request includes User's JWT for auth
    Sync->>Sync: Validate JWT
    Sync->>Sync: Add user to room's client list
    Sync-->>U: WebSocket Connection Established
    Sync->>U: SEND {"type": "ROOM_STATE", "payload": ...}
    Sync->>Sync: Broadcast to other clients: {"type": "USER_JOINED", "payload": ...}